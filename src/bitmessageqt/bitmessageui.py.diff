--- bitmessageui.py.orig	2024-05-13 08:32:22.376971328 +0900
+++ bitmessageui.py	2024-05-14 15:56:24.921713575 +0900
@@ -7,7 +7,11 @@
 
 
 from PyQt6 import QtCore, QtGui, QtWidgets
-
+from bmconfigparser import config
+from .foldertree import AddressBookCompleter
+from .blacklist import Blacklist
+import bitmessageqt.settingsmixin as settingsmixin
+from .networkstatus import NetworkStatus
 
 class Ui_MainWindow(object):
     def setupUi(self, MainWindow):
@@ -140,6 +144,11 @@
         self.tableWidgetAddressBook.horizontalHeader().setStretchLastSection(True)
         self.tableWidgetAddressBook.verticalHeader().setVisible(False)
         self.verticalLayout_2.addWidget(self.tableWidgetAddressBook)
+        self.addressBookCompleter = AddressBookCompleter()
+        self.addressBookCompleter.setCompletionMode(QtWidgets.QCompleter.CompletionMode.PopupCompletion)
+        self.addressBookCompleter.setCaseSensitivity(QtCore.Qt.CaseSensitivity.CaseInsensitive)
+        self.addressBookCompleterModel = QtCore.QStringListModel()
+        self.addressBookCompleter.setModel(self.addressBookCompleterModel)
         self.pushButtonAddAddressBook = QtWidgets.QPushButton(parent=self.send)
         self.pushButtonAddAddressBook.setMaximumSize(QtCore.QSize(200, 16777215))
         self.pushButtonAddAddressBook.setObjectName("pushButtonAddAddressBook")
@@ -156,40 +165,41 @@
         self.verticalLayout.setObjectName("verticalLayout")
         self.tabWidgetSend = QtWidgets.QTabWidget(parent=self.send)
         self.tabWidgetSend.setObjectName("tabWidgetSend")
-        self.tab = QtWidgets.QWidget()
-        self.tab.setObjectName("tab")
-        self.gridLayout_8 = QtWidgets.QGridLayout(self.tab)
+        self.sendDirect = QtWidgets.QWidget()
+        self.sendDirect.setObjectName("sendDirect")
+        self.gridLayout_8 = QtWidgets.QGridLayout(self.sendDirect)
         self.gridLayout_8.setObjectName("gridLayout_8")
         self.verticalLayout_5 = QtWidgets.QVBoxLayout()
         self.verticalLayout_5.setObjectName("verticalLayout_5")
         self.gridLayout_2 = QtWidgets.QGridLayout()
         self.gridLayout_2.setObjectName("gridLayout_2")
-        self.label_3 = QtWidgets.QLabel(parent=self.tab)
+        self.label_3 = QtWidgets.QLabel(parent=self.sendDirect)
         self.label_3.setObjectName("label_3")
         self.gridLayout_2.addWidget(self.label_3, 2, 0, 1, 1)
-        self.label_2 = QtWidgets.QLabel(parent=self.tab)
+        self.label_2 = QtWidgets.QLabel(parent=self.sendDirect)
         self.label_2.setObjectName("label_2")
         self.gridLayout_2.addWidget(self.label_2, 0, 0, 1, 1)
-        self.lineEditSubject = QtWidgets.QLineEdit(parent=self.tab)
+        self.lineEditSubject = QtWidgets.QLineEdit(parent=self.sendDirect)
         self.lineEditSubject.setText("")
         self.lineEditSubject.setObjectName("lineEditSubject")
         self.gridLayout_2.addWidget(self.lineEditSubject, 2, 1, 1, 1)
-        self.label = QtWidgets.QLabel(parent=self.tab)
+        self.label = QtWidgets.QLabel(parent=self.sendDirect)
         self.label.setObjectName("label")
         self.gridLayout_2.addWidget(self.label, 1, 0, 1, 1)
-        self.comboBoxSendFrom = QtWidgets.QComboBox(parent=self.tab)
+        self.comboBoxSendFrom = QtWidgets.QComboBox(parent=self.sendDirect)
         self.comboBoxSendFrom.setMinimumSize(QtCore.QSize(300, 0))
         self.comboBoxSendFrom.setObjectName("comboBoxSendFrom")
         self.gridLayout_2.addWidget(self.comboBoxSendFrom, 0, 1, 1, 1)
-        self.lineEditTo = QtWidgets.QLineEdit(parent=self.tab)
+        self.lineEditTo = QtWidgets.QLineEdit(parent=self.sendDirect)
         self.lineEditTo.setObjectName("lineEditTo")
         self.gridLayout_2.addWidget(self.lineEditTo, 1, 1, 1, 1)
+        self.lineEditTo.setCompleter(self.addressBookCompleter)
         self.verticalLayout_5.addLayout(self.gridLayout_2)
-        self.textEditMessage = QtWidgets.QTextEdit(parent=self.tab)
+        self.textEditMessage = QtWidgets.QTextEdit(parent=self.sendDirect)
         self.textEditMessage.setObjectName("textEditMessage")
         self.verticalLayout_5.addWidget(self.textEditMessage)
         self.gridLayout_8.addLayout(self.verticalLayout_5, 0, 0, 1, 1)
-        self.tabWidgetSend.addTab(self.tab, "")
+        self.tabWidgetSend.addTab(self.sendDirect, "")
         self.tab_2 = QtWidgets.QWidget()
         self.tab_2.setObjectName("tab_2")
         self.gridLayout_9 = QtWidgets.QGridLayout(self.tab_2)
@@ -263,6 +273,9 @@
         self.labelHumanFriendlyTTLDescription.setMaximumSize(QtCore.QSize(45, 16777215))
         self.labelHumanFriendlyTTLDescription.setObjectName("labelHumanFriendlyTTLDescription")
         self.horizontalLayout_5.addWidget(self.labelHumanFriendlyTTLDescription)
+        self.pushButtonClear = QtWidgets.QPushButton(parent=self.send)
+        self.pushButtonClear.setObjectName("pushButtonClear")
+        self.horizontalLayout_5.addWidget(self.pushButtonClear, 0, QtCore.Qt.AlignmentFlag.AlignRight)
         self.pushButtonSend = QtWidgets.QPushButton(parent=self.send)
         self.pushButtonSend.setMaximumSize(QtCore.QSize(16777215, 16777215))
         self.pushButtonSend.setObjectName("pushButtonSend")
@@ -348,15 +361,15 @@
         icon6 = QtGui.QIcon()
         icon6.addPixmap(QtGui.QPixmap(":/newPrefix/images/subscriptions.png"), QtGui.QIcon.Mode.Normal, QtGui.QIcon.State.Off)
         self.tabWidget.addTab(self.subscriptions, icon6, "")
-        self.tab_3 = QtWidgets.QWidget()
-        self.tab_3.setObjectName("tab_3")
-        self.gridLayout_4 = QtWidgets.QGridLayout(self.tab_3)
+        self.chans = QtWidgets.QWidget()
+        self.chans.setObjectName("chans")
+        self.gridLayout_4 = QtWidgets.QGridLayout(self.chans)
         self.gridLayout_4.setObjectName("gridLayout_4")
         self.horizontalLayout_7 = QtWidgets.QHBoxLayout()
         self.horizontalLayout_7.setObjectName("horizontalLayout_7")
         self.verticalLayout_17 = QtWidgets.QVBoxLayout()
         self.verticalLayout_17.setObjectName("verticalLayout_17")
-        self.treeWidgetChans = QtWidgets.QTreeWidget(parent=self.tab_3)
+        self.treeWidgetChans = QtWidgets.QTreeWidget(parent=self.chans)
         self.treeWidgetChans.setMaximumSize(QtCore.QSize(200, 16777215))
         self.treeWidgetChans.setFrameShadow(QtWidgets.QFrame.Shadow.Sunken)
         self.treeWidgetChans.setLineWidth(1)
@@ -368,7 +381,7 @@
         icon7.addPixmap(QtGui.QPixmap(":/newPrefix/images/can-icon-16px.png"), QtGui.QIcon.Mode.Selected, QtGui.QIcon.State.Off)
         self.treeWidgetChans.headerItem().setIcon(0, icon7)
         self.verticalLayout_17.addWidget(self.treeWidgetChans)
-        self.pushButtonAddChan = QtWidgets.QPushButton(parent=self.tab_3)
+        self.pushButtonAddChan = QtWidgets.QPushButton(parent=self.chans)
         self.pushButtonAddChan.setMaximumSize(QtCore.QSize(200, 16777215))
         self.pushButtonAddChan.setObjectName("pushButtonAddChan")
         self.verticalLayout_17.addWidget(self.pushButtonAddChan)
@@ -377,10 +390,10 @@
         self.verticalLayout_8.setObjectName("verticalLayout_8")
         self.horizontalLayout_6 = QtWidgets.QHBoxLayout()
         self.horizontalLayout_6.setObjectName("horizontalLayout_6")
-        self.inboxSearchLineEditChans = QtWidgets.QLineEdit(parent=self.tab_3)
+        self.inboxSearchLineEditChans = QtWidgets.QLineEdit(parent=self.chans)
         self.inboxSearchLineEditChans.setObjectName("inboxSearchLineEditChans")
         self.horizontalLayout_6.addWidget(self.inboxSearchLineEditChans)
-        self.inboxSearchOptionChans = QtWidgets.QComboBox(parent=self.tab_3)
+        self.inboxSearchOptionChans = QtWidgets.QComboBox(parent=self.chans)
         self.inboxSearchOptionChans.setObjectName("inboxSearchOptionChans")
         self.inboxSearchOptionChans.addItem("")
         self.inboxSearchOptionChans.addItem("")
@@ -389,7 +402,7 @@
         self.inboxSearchOptionChans.addItem("")
         self.horizontalLayout_6.addWidget(self.inboxSearchOptionChans)
         self.verticalLayout_8.addLayout(self.horizontalLayout_6)
-        self.tableWidgetInboxChans = QtWidgets.QTableWidget(parent=self.tab_3)
+        self.tableWidgetInboxChans = QtWidgets.QTableWidget(parent=self.chans)
         self.tableWidgetInboxChans.setEditTriggers(QtWidgets.QAbstractItemView.EditTrigger.NoEditTriggers)
         self.tableWidgetInboxChans.setAlternatingRowColors(True)
         self.tableWidgetInboxChans.setSelectionMode(QtWidgets.QAbstractItemView.SelectionMode.ExtendedSelection)
@@ -415,7 +428,7 @@
         self.tableWidgetInboxChans.verticalHeader().setVisible(False)
         self.tableWidgetInboxChans.verticalHeader().setDefaultSectionSize(26)
         self.verticalLayout_8.addWidget(self.tableWidgetInboxChans)
-        self.textEditInboxMessageChans = QtWidgets.QTextEdit(parent=self.tab_3)
+        self.textEditInboxMessageChans = QtWidgets.QTextEdit(parent=self.chans)
         self.textEditInboxMessageChans.setBaseSize(QtCore.QSize(0, 500))
         self.textEditInboxMessageChans.setReadOnly(True)
         self.textEditInboxMessageChans.setObjectName("textEditInboxMessageChans")
@@ -424,113 +437,20 @@
         self.gridLayout_4.addLayout(self.horizontalLayout_7, 0, 0, 1, 1)
         icon8 = QtGui.QIcon()
         icon8.addPixmap(QtGui.QPixmap(":/newPrefix/images/can-icon-16px.png"), QtGui.QIcon.Mode.Normal, QtGui.QIcon.State.Off)
-        self.tabWidget.addTab(self.tab_3, icon8, "")
-        self.blackwhitelist = QtWidgets.QWidget()
+        self.tabWidget.addTab(self.chans, icon8, "")
+        self.blackwhitelist = Blacklist()
         self.blackwhitelist.setObjectName("blackwhitelist")
-        self.gridLayout_6 = QtWidgets.QGridLayout(self.blackwhitelist)
-        self.gridLayout_6.setObjectName("gridLayout_6")
-        self.radioButtonBlacklist = QtWidgets.QRadioButton(parent=self.blackwhitelist)
-        self.radioButtonBlacklist.setChecked(True)
-        self.radioButtonBlacklist.setObjectName("radioButtonBlacklist")
-        self.gridLayout_6.addWidget(self.radioButtonBlacklist, 0, 0, 1, 2)
-        self.radioButtonWhitelist = QtWidgets.QRadioButton(parent=self.blackwhitelist)
-        self.radioButtonWhitelist.setObjectName("radioButtonWhitelist")
-        self.gridLayout_6.addWidget(self.radioButtonWhitelist, 1, 0, 1, 2)
-        self.pushButtonAddBlacklist = QtWidgets.QPushButton(parent=self.blackwhitelist)
-        self.pushButtonAddBlacklist.setObjectName("pushButtonAddBlacklist")
-        self.gridLayout_6.addWidget(self.pushButtonAddBlacklist, 2, 0, 1, 1)
-        spacerItem = QtWidgets.QSpacerItem(689, 20, QtWidgets.QSizePolicy.Policy.Expanding, QtWidgets.QSizePolicy.Policy.Minimum)
-        self.gridLayout_6.addItem(spacerItem, 2, 1, 1, 1)
-        self.tableWidgetBlacklist = QtWidgets.QTableWidget(parent=self.blackwhitelist)
-        self.tableWidgetBlacklist.setAlternatingRowColors(True)
-        self.tableWidgetBlacklist.setSelectionMode(QtWidgets.QAbstractItemView.SelectionMode.SingleSelection)
-        self.tableWidgetBlacklist.setSelectionBehavior(QtWidgets.QAbstractItemView.SelectionBehavior.SelectRows)
-        self.tableWidgetBlacklist.setObjectName("tableWidgetBlacklist")
-        self.tableWidgetBlacklist.setColumnCount(2)
-        self.tableWidgetBlacklist.setRowCount(0)
-        item = QtWidgets.QTableWidgetItem()
-        self.tableWidgetBlacklist.setHorizontalHeaderItem(0, item)
-        item = QtWidgets.QTableWidgetItem()
-        self.tableWidgetBlacklist.setHorizontalHeaderItem(1, item)
-        self.tableWidgetBlacklist.horizontalHeader().setCascadingSectionResizes(True)
-        self.tableWidgetBlacklist.horizontalHeader().setDefaultSectionSize(400)
-        self.tableWidgetBlacklist.horizontalHeader().setHighlightSections(False)
-        self.tableWidgetBlacklist.horizontalHeader().setSortIndicatorShown(False)
-        self.tableWidgetBlacklist.horizontalHeader().setStretchLastSection(True)
-        self.tableWidgetBlacklist.verticalHeader().setVisible(False)
-        self.gridLayout_6.addWidget(self.tableWidgetBlacklist, 3, 0, 1, 2)
-        icon9 = QtGui.QIcon()
-        icon9.addPixmap(QtGui.QPixmap(":/newPrefix/images/blacklist.png"), QtGui.QIcon.Mode.Normal, QtGui.QIcon.State.Off)
-        self.tabWidget.addTab(self.blackwhitelist, icon9, "")
-        self.networkstatus = QtWidgets.QWidget()
-        self.networkstatus.setObjectName("networkstatus")
-        self.pushButtonStatusIcon = QtWidgets.QPushButton(parent=self.networkstatus)
-        self.pushButtonStatusIcon.setGeometry(QtCore.QRect(680, 440, 21, 23))
-        self.pushButtonStatusIcon.setText("")
-        icon10 = QtGui.QIcon()
-        icon10.addPixmap(QtGui.QPixmap(":/newPrefix/images/redicon.png"), QtGui.QIcon.Mode.Normal, QtGui.QIcon.State.Off)
-        self.pushButtonStatusIcon.setIcon(icon10)
-        self.pushButtonStatusIcon.setFlat(True)
-        self.pushButtonStatusIcon.setObjectName("pushButtonStatusIcon")
-        self.tableWidgetConnectionCount = QtWidgets.QTableWidget(parent=self.networkstatus)
-        self.tableWidgetConnectionCount.setGeometry(QtCore.QRect(20, 70, 241, 241))
-        palette = QtGui.QPalette()
-        brush = QtGui.QBrush(QtGui.QColor(212, 208, 200))
-        brush.setStyle(QtCore.Qt.BrushStyle.SolidPattern)
-        palette.setBrush(QtGui.QPalette.ColorGroup.Active, QtGui.QPalette.ColorRole.Base, brush)
-        brush = QtGui.QBrush(QtGui.QColor(212, 208, 200))
-        brush.setStyle(QtCore.Qt.BrushStyle.SolidPattern)
-        palette.setBrush(QtGui.QPalette.ColorGroup.Inactive, QtGui.QPalette.ColorRole.Base, brush)
-        brush = QtGui.QBrush(QtGui.QColor(212, 208, 200))
-        brush.setStyle(QtCore.Qt.BrushStyle.SolidPattern)
-        palette.setBrush(QtGui.QPalette.ColorGroup.Disabled, QtGui.QPalette.ColorRole.Base, brush)
-        self.tableWidgetConnectionCount.setPalette(palette)
-        self.tableWidgetConnectionCount.setFrameShape(QtWidgets.QFrame.Shape.Box)
-        self.tableWidgetConnectionCount.setFrameShadow(QtWidgets.QFrame.Shadow.Plain)
-        self.tableWidgetConnectionCount.setProperty("showDropIndicator", False)
-        self.tableWidgetConnectionCount.setAlternatingRowColors(True)
-        self.tableWidgetConnectionCount.setSelectionMode(QtWidgets.QAbstractItemView.SelectionMode.NoSelection)
-        self.tableWidgetConnectionCount.setObjectName("tableWidgetConnectionCount")
-        self.tableWidgetConnectionCount.setColumnCount(2)
-        self.tableWidgetConnectionCount.setRowCount(0)
-        item = QtWidgets.QTableWidgetItem()
-        self.tableWidgetConnectionCount.setHorizontalHeaderItem(0, item)
-        item = QtWidgets.QTableWidgetItem()
-        self.tableWidgetConnectionCount.setHorizontalHeaderItem(1, item)
-        self.tableWidgetConnectionCount.horizontalHeader().setCascadingSectionResizes(True)
-        self.tableWidgetConnectionCount.horizontalHeader().setHighlightSections(False)
-        self.tableWidgetConnectionCount.horizontalHeader().setStretchLastSection(True)
-        self.tableWidgetConnectionCount.verticalHeader().setVisible(False)
-        self.labelTotalConnections = QtWidgets.QLabel(parent=self.networkstatus)
-        self.labelTotalConnections.setGeometry(QtCore.QRect(20, 30, 401, 16))
-        self.labelTotalConnections.setObjectName("labelTotalConnections")
-        self.labelStartupTime = QtWidgets.QLabel(parent=self.networkstatus)
-        self.labelStartupTime.setGeometry(QtCore.QRect(320, 110, 331, 20))
-        self.labelStartupTime.setObjectName("labelStartupTime")
-        self.labelMessageCount = QtWidgets.QLabel(parent=self.networkstatus)
-        self.labelMessageCount.setGeometry(QtCore.QRect(350, 130, 361, 16))
-        self.labelMessageCount.setObjectName("labelMessageCount")
-        self.labelPubkeyCount = QtWidgets.QLabel(parent=self.networkstatus)
-        self.labelPubkeyCount.setGeometry(QtCore.QRect(350, 170, 331, 16))
-        self.labelPubkeyCount.setObjectName("labelPubkeyCount")
-        self.labelBroadcastCount = QtWidgets.QLabel(parent=self.networkstatus)
-        self.labelBroadcastCount.setGeometry(QtCore.QRect(350, 150, 351, 16))
-        self.labelBroadcastCount.setObjectName("labelBroadcastCount")
-        self.labelLookupsPerSecond = QtWidgets.QLabel(parent=self.networkstatus)
-        self.labelLookupsPerSecond.setGeometry(QtCore.QRect(320, 250, 291, 16))
-        self.labelLookupsPerSecond.setObjectName("labelLookupsPerSecond")
-        self.labelBytesRecvCount = QtWidgets.QLabel(parent=self.networkstatus)
-        self.labelBytesRecvCount.setGeometry(QtCore.QRect(350, 210, 251, 16))
-        self.labelBytesRecvCount.setObjectName("labelBytesRecvCount")
-        self.labelBytesSentCount = QtWidgets.QLabel(parent=self.networkstatus)
-        self.labelBytesSentCount.setGeometry(QtCore.QRect(350, 230, 251, 16))
-        self.labelBytesSentCount.setObjectName("labelBytesSentCount")
-        icon11 = QtGui.QIcon()
-        icon11.addPixmap(QtGui.QPixmap(":/newPrefix/images/networkstatus.png"), QtGui.QIcon.Mode.Normal, QtGui.QIcon.State.Off)
-        self.tabWidget.addTab(self.networkstatus, icon11, "")
+        self.tabWidget.addTab(self.blackwhitelist, QtGui.QIcon(":/newPrefix/images/blacklist.png"), "")
+        # Initialize the Blacklist or Whitelist
+        if config.get('bitmessagesettings', 'blackwhitelist') == 'white':
+            self.blackwhitelist.radioButtonWhitelist.click()
+        self.blackwhitelist.rerenderBlackWhiteList()
+
+        self.networkstatus = NetworkStatus()
+        self.tabWidget.addTab(self.networkstatus, QtGui.QIcon(":/newPrefix/images/networkstatus.png"), "")
         self.gridLayout_10.addWidget(self.tabWidget, 0, 0, 1, 1)
         self.MainDock.setWidget(self.centralwidget)
-        MainWindow.addDockWidget(QtCore.Qt.DockWidgetArea(None), self.MainDock)
+        MainWindow.addDockWidget(QtCore.Qt.DockWidgetArea.AllDockWidgetAreas, self.MainDock)
         self.menubar = QtWidgets.QMenuBar(parent=MainWindow)
         self.menubar.setGeometry(QtCore.QRect(0, 0, 885, 27))
         self.menubar.setObjectName("menubar")
@@ -550,6 +470,8 @@
         self.actionManageKeys = QtGui.QAction(parent=MainWindow)
         self.actionManageKeys.setCheckable(False)
         self.actionManageKeys.setEnabled(True)
+        self.actionNetworkSwitch = QtGui.QAction(parent=MainWindow)
+        self.actionNetworkSwitch.setObjectName("actionNetworkSwitch")
         icon = QtGui.QIcon.fromTheme("dialog-password")
         self.actionManageKeys.setIcon(icon)
         self.actionManageKeys.setObjectName("actionManageKeys")
@@ -561,6 +483,10 @@
         icon = QtGui.QIcon.fromTheme("help-contents")
         self.actionHelp.setIcon(icon)
         self.actionHelp.setObjectName("actionHelp")
+        self.actionSupport = QtGui.QAction(MainWindow)
+        icon = QtGui.QIcon.fromTheme("help-support")
+        self.actionSupport.setIcon(icon)
+        self.actionSupport.setObjectName("actionSupport")
         self.actionAbout = QtGui.QAction(parent=MainWindow)
         icon = QtGui.QIcon.fromTheme("help-about")
         self.actionAbout.setIcon(icon)
@@ -584,17 +510,23 @@
         self.menuFile.addAction(self.actionManageKeys)
         self.menuFile.addAction(self.actionDeleteAllTrashedMessages)
         self.menuFile.addAction(self.actionRegenerateDeterministicAddresses)
+        self.menuFile.addAction(self.actionNetworkSwitch)
         self.menuFile.addAction(self.actionExit)
         self.menuSettings.addAction(self.actionSettings)
         self.menuHelp.addAction(self.actionHelp)
+        self.menuHelp.addAction(self.actionSupport)
         self.menuHelp.addAction(self.actionAbout)
         self.menubar.addAction(self.menuFile.menuAction())
         self.menubar.addAction(self.menuSettings.menuAction())
         self.menubar.addAction(self.menuHelp.menuAction())
 
         self.retranslateUi(MainWindow)
-        self.tabWidget.setCurrentIndex(0)
-        self.tabWidgetSend.setCurrentIndex(0)
+        self.tabWidget.setCurrentIndex(
+            self.tabWidget.indexOf(self.inbox)
+        )
+        self.tabWidgetSend.setCurrentIndex(
+            self.tabWidgetSend.indexOf(self.sendDirect)
+        )
         QtCore.QMetaObject.connectSlotsByName(MainWindow)
         MainWindow.setTabOrder(self.tableWidgetInbox, self.textEditInboxMessage)
         MainWindow.setTabOrder(self.textEditInboxMessage, self.comboBoxSendFrom)
@@ -603,12 +535,26 @@
         MainWindow.setTabOrder(self.lineEditSubject, self.textEditMessage)
         MainWindow.setTabOrder(self.textEditMessage, self.pushButtonSend)
         MainWindow.setTabOrder(self.pushButtonSend, self.pushButtonAddSubscription)
-        MainWindow.setTabOrder(self.pushButtonAddSubscription, self.radioButtonBlacklist)
-        MainWindow.setTabOrder(self.radioButtonBlacklist, self.radioButtonWhitelist)
-        MainWindow.setTabOrder(self.radioButtonWhitelist, self.pushButtonAddBlacklist)
-        MainWindow.setTabOrder(self.pushButtonAddBlacklist, self.tableWidgetBlacklist)
-        MainWindow.setTabOrder(self.tableWidgetBlacklist, self.tableWidgetConnectionCount)
-        MainWindow.setTabOrder(self.tableWidgetConnectionCount, self.pushButtonStatusIcon)
+
+        # Popup menu actions container for the Sent page
+        # pylint: disable=attribute-defined-outside-init
+        self.sentContextMenuToolbar = QtWidgets.QToolBar()
+        # Popup menu actions container for chans tree
+        self.addressContextMenuToolbar = QtWidgets.QToolBar()
+        # Popup menu actions container for subscriptions tree
+        self.subscriptionsContextMenuToolbar = QtWidgets.QToolBar()
+
+    def updateNetworkSwitchMenuLabel(self, dontconnect=None):
+        _translate = QtCore.QCoreApplication.translate
+        if dontconnect is None:
+            _translate = QtCore.QCoreApplication.translate
+            dontconnect = config.safeGetBoolean(
+                'bitmessagesettings', 'dontconnect')
+        self.actionNetworkSwitch.setText(
+            _translate("MainWindow", "Go online", None)
+            if dontconnect else
+            _translate("MainWindow", "Go offline", None)
+        )
 
     def retranslateUi(self, MainWindow):
         _translate = QtCore.QCoreApplication.translate
@@ -646,7 +592,7 @@
 "p, li { white-space: pre-wrap; }\n"
 "</style></head><body style=\" font-family:\'Droid Sans\'; font-size:9pt; font-weight:400; font-style:normal;\">\n"
 "<p style=\"-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:\'MS Shell Dlg 2\';\"><br /></p></body></html>"))
-        self.tabWidgetSend.setTabText(self.tabWidgetSend.indexOf(self.tab), _translate("MainWindow", "Send ordinary Message"))
+        self.tabWidgetSend.setTabText(self.tabWidgetSend.indexOf(self.sendDirect), _translate("MainWindow", "Send ordinary Message"))
         self.label_8.setText(_translate("MainWindow", "From:"))
         self.label_7.setText(_translate("MainWindow", "Subject:"))
         self.textEditMessageBroadcast.setHtml(_translate("MainWindow", "<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0//EN\" \"http://www.w3.org/TR/REC-html40/strict.dtd\">\n"
@@ -656,7 +602,7 @@
 "<p style=\"-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:\'MS Shell Dlg 2\';\"><br /></p></body></html>"))
         self.tabWidgetSend.setTabText(self.tabWidgetSend.indexOf(self.tab_2), _translate("MainWindow", "Send Message to your Subscribers"))
         self.pushButtonTTL.setText(_translate("MainWindow", "TTL:"))
-        self.labelHumanFriendlyTTLDescription.setText(_translate("MainWindow", "X days"))
+        self.pushButtonClear.setText(_translate("MainWindow", "Clear"))
         self.pushButtonSend.setText(_translate("MainWindow", "Send"))
         self.tabWidget.setTabText(self.tabWidget.indexOf(self.send), _translate("MainWindow", "Send"))
         self.treeWidgetSubscriptions.headerItem().setText(0, _translate("MainWindow", "Subscriptions"))
@@ -694,28 +640,8 @@
         item.setText(_translate("MainWindow", "Subject"))
         item = self.tableWidgetInboxChans.horizontalHeaderItem(3)
         item.setText(_translate("MainWindow", "Received"))
-        self.tabWidget.setTabText(self.tabWidget.indexOf(self.tab_3), _translate("MainWindow", "Chans"))
-        self.radioButtonBlacklist.setText(_translate("MainWindow", "Use a Blacklist (Allow all incoming messages except those on the Blacklist)"))
-        self.radioButtonWhitelist.setText(_translate("MainWindow", "Use a Whitelist (Block all incoming messages except those on the Whitelist)"))
-        self.pushButtonAddBlacklist.setText(_translate("MainWindow", "Add new entry"))
-        self.tableWidgetBlacklist.setSortingEnabled(True)
-        item = self.tableWidgetBlacklist.horizontalHeaderItem(0)
-        item.setText(_translate("MainWindow", "Name or Label"))
-        item = self.tableWidgetBlacklist.horizontalHeaderItem(1)
-        item.setText(_translate("MainWindow", "Address"))
-        self.tabWidget.setTabText(self.tabWidget.indexOf(self.blackwhitelist), _translate("MainWindow", "Blacklist"))
-        item = self.tableWidgetConnectionCount.horizontalHeaderItem(0)
-        item.setText(_translate("MainWindow", "Stream #"))
-        item = self.tableWidgetConnectionCount.horizontalHeaderItem(1)
-        item.setText(_translate("MainWindow", "Connections"))
-        self.labelTotalConnections.setText(_translate("MainWindow", "Total connections:"))
-        self.labelStartupTime.setText(_translate("MainWindow", "Since startup:"))
-        self.labelMessageCount.setText(_translate("MainWindow", "Processed 0 person-to-person messages."))
-        self.labelPubkeyCount.setText(_translate("MainWindow", "Processed 0 public keys."))
-        self.labelBroadcastCount.setText(_translate("MainWindow", "Processed 0 broadcasts."))
-        self.labelLookupsPerSecond.setText(_translate("MainWindow", "Inventory lookups per second: 0"))
-        self.labelBytesRecvCount.setText(_translate("MainWindow", "Down: 0 KB/s"))
-        self.labelBytesSentCount.setText(_translate("MainWindow", "Up: 0 KB/s"))
+        self.tabWidget.setTabText(self.tabWidget.indexOf(self.chans), _translate("MainWindow", "Chans"))
+        self.networkstatus.retranslateUi()
         self.tabWidget.setTabText(self.tabWidget.indexOf(self.networkstatus), _translate("MainWindow", "Network Status"))
         self.menuFile.setTitle(_translate("MainWindow", "File"))
         self.menuSettings.setTitle(_translate("MainWindow", "Settings"))
@@ -726,8 +652,10 @@
         self.actionExit.setShortcut(_translate("MainWindow", "Ctrl+Q"))
         self.actionHelp.setText(_translate("MainWindow", "Help"))
         self.actionHelp.setShortcut(_translate("MainWindow", "F1"))
+        self.actionSupport.setText(_translate("MainWindow", "Contact support"))
         self.actionAbout.setText(_translate("MainWindow", "About"))
         self.actionSettings.setText(_translate("MainWindow", "Settings"))
         self.actionRegenerateDeterministicAddresses.setText(_translate("MainWindow", "Regenerate deterministic addresses"))
         self.actionDeleteAllTrashedMessages.setText(_translate("MainWindow", "Delete all trashed messages"))
         self.actionJoinChan.setText(_translate("MainWindow", "Join / Create chan"))
+        self.updateNetworkSwitchMenuLabel()
