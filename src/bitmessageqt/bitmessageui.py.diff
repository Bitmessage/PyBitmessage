--- bitmessageui.py.orig	2024-05-13 08:32:22.376971328 +0900
+++ bitmessageui.py	2024-05-13 09:48:39.354481762 +0900
@@ -7,7 +7,10 @@
 
 
 from PyQt6 import QtCore, QtGui, QtWidgets
-
+from bmconfigparser import config
+from .foldertree import AddressBookCompleter
+from .blacklist import Blacklist
+from .networkstatus import NetworkStatus
 
 class Ui_MainWindow(object):
     def setupUi(self, MainWindow):
@@ -140,6 +143,11 @@
         self.tableWidgetAddressBook.horizontalHeader().setStretchLastSection(True)
         self.tableWidgetAddressBook.verticalHeader().setVisible(False)
         self.verticalLayout_2.addWidget(self.tableWidgetAddressBook)
+        self.addressBookCompleter = AddressBookCompleter()
+        self.addressBookCompleter.setCompletionMode(QtWidgets.QCompleter.CompletionMode.PopupCompletion)
+        self.addressBookCompleter.setCaseSensitivity(QtCore.Qt.CaseSensitivity.CaseInsensitive)
+        self.addressBookCompleterModel = QtCore.QStringListModel()
+        self.addressBookCompleter.setModel(self.addressBookCompleterModel)
         self.pushButtonAddAddressBook = QtWidgets.QPushButton(parent=self.send)
         self.pushButtonAddAddressBook.setMaximumSize(QtCore.QSize(200, 16777215))
         self.pushButtonAddAddressBook.setObjectName("pushButtonAddAddressBook")
@@ -184,6 +192,7 @@
         self.lineEditTo = QtWidgets.QLineEdit(parent=self.tab)
         self.lineEditTo.setObjectName("lineEditTo")
         self.gridLayout_2.addWidget(self.lineEditTo, 1, 1, 1, 1)
+        self.lineEditTo.setCompleter(self.addressBookCompleter)
         self.verticalLayout_5.addLayout(self.gridLayout_2)
         self.textEditMessage = QtWidgets.QTextEdit(parent=self.tab)
         self.textEditMessage.setObjectName("textEditMessage")
@@ -263,6 +272,9 @@
         self.labelHumanFriendlyTTLDescription.setMaximumSize(QtCore.QSize(45, 16777215))
         self.labelHumanFriendlyTTLDescription.setObjectName("labelHumanFriendlyTTLDescription")
         self.horizontalLayout_5.addWidget(self.labelHumanFriendlyTTLDescription)
+        self.pushButtonClear = QtWidgets.QPushButton(parent=self.send)
+        self.pushButtonClear.setObjectName("pushButtonClear")
+        self.horizontalLayout_5.addWidget(self.pushButtonClear, 0, QtCore.Qt.AlignmentFlag.AlignRight)
         self.pushButtonSend = QtWidgets.QPushButton(parent=self.send)
         self.pushButtonSend.setMaximumSize(QtCore.QSize(16777215, 16777215))
         self.pushButtonSend.setObjectName("pushButtonSend")
@@ -425,8 +437,14 @@
         icon8 = QtGui.QIcon()
         icon8.addPixmap(QtGui.QPixmap(":/newPrefix/images/can-icon-16px.png"), QtGui.QIcon.Mode.Normal, QtGui.QIcon.State.Off)
         self.tabWidget.addTab(self.tab_3, icon8, "")
-        self.blackwhitelist = QtWidgets.QWidget()
+        self.blackwhitelist = Blacklist()
         self.blackwhitelist.setObjectName("blackwhitelist")
+        self.tabWidget.addTab(self.blackwhitelist, QtGui.QIcon(":/newPrefix/images/blacklist.png"), "")
+        # Initialize the Blacklist or Whitelist
+        if config.get('bitmessagesettings', 'blackwhitelist') == 'white':
+            self.blackwhitelist.radioButtonWhitelist.click()
+        self.blackwhitelist.rerenderBlackWhiteList()
+
         self.gridLayout_6 = QtWidgets.QGridLayout(self.blackwhitelist)
         self.gridLayout_6.setObjectName("gridLayout_6")
         self.radioButtonBlacklist = QtWidgets.QRadioButton(parent=self.blackwhitelist)
@@ -462,7 +480,8 @@
         icon9 = QtGui.QIcon()
         icon9.addPixmap(QtGui.QPixmap(":/newPrefix/images/blacklist.png"), QtGui.QIcon.Mode.Normal, QtGui.QIcon.State.Off)
         self.tabWidget.addTab(self.blackwhitelist, icon9, "")
-        self.networkstatus = QtWidgets.QWidget()
+        self.networkstatus = NetworkStatus()
+        self.tabWidget.addTab(self.networkstatus, QtGui.QIcon(":/newPrefix/images/networkstatus.png"), "")
         self.networkstatus.setObjectName("networkstatus")
         self.pushButtonStatusIcon = QtWidgets.QPushButton(parent=self.networkstatus)
         self.pushButtonStatusIcon.setGeometry(QtCore.QRect(680, 440, 21, 23))
@@ -530,7 +549,7 @@
         self.tabWidget.addTab(self.networkstatus, icon11, "")
         self.gridLayout_10.addWidget(self.tabWidget, 0, 0, 1, 1)
         self.MainDock.setWidget(self.centralwidget)
-        MainWindow.addDockWidget(QtCore.Qt.DockWidgetArea(None), self.MainDock)
+        MainWindow.addDockWidget(QtCore.Qt.DockWidgetArea.AllDockWidgetAreas, self.MainDock)
         self.menubar = QtWidgets.QMenuBar(parent=MainWindow)
         self.menubar.setGeometry(QtCore.QRect(0, 0, 885, 27))
         self.menubar.setObjectName("menubar")
@@ -550,6 +569,8 @@
         self.actionManageKeys = QtGui.QAction(parent=MainWindow)
         self.actionManageKeys.setCheckable(False)
         self.actionManageKeys.setEnabled(True)
+        self.actionNetworkSwitch = QtGui.QAction(parent=MainWindow)
+        self.actionNetworkSwitch.setObjectName("actionNetworkSwitch")
         icon = QtGui.QIcon.fromTheme("dialog-password")
         self.actionManageKeys.setIcon(icon)
         self.actionManageKeys.setObjectName("actionManageKeys")
@@ -561,6 +582,10 @@
         icon = QtGui.QIcon.fromTheme("help-contents")
         self.actionHelp.setIcon(icon)
         self.actionHelp.setObjectName("actionHelp")
+        self.actionSupport = QtGui.QAction(MainWindow)
+        icon = QtGui.QIcon.fromTheme("help-support")
+        self.actionSupport.setIcon(icon)
+        self.actionSupport.setObjectName("actionSupport")
         self.actionAbout = QtGui.QAction(parent=MainWindow)
         icon = QtGui.QIcon.fromTheme("help-about")
         self.actionAbout.setIcon(icon)
@@ -584,9 +609,11 @@
         self.menuFile.addAction(self.actionManageKeys)
         self.menuFile.addAction(self.actionDeleteAllTrashedMessages)
         self.menuFile.addAction(self.actionRegenerateDeterministicAddresses)
+        self.menuFile.addAction(self.actionNetworkSwitch)
         self.menuFile.addAction(self.actionExit)
         self.menuSettings.addAction(self.actionSettings)
         self.menuHelp.addAction(self.actionHelp)
+        self.menuHelp.addAction(self.actionSupport)
         self.menuHelp.addAction(self.actionAbout)
         self.menubar.addAction(self.menuFile.menuAction())
         self.menubar.addAction(self.menuSettings.menuAction())
@@ -610,6 +637,26 @@
         MainWindow.setTabOrder(self.tableWidgetBlacklist, self.tableWidgetConnectionCount)
         MainWindow.setTabOrder(self.tableWidgetConnectionCount, self.pushButtonStatusIcon)
 
+        # Popup menu actions container for the Sent page
+        # pylint: disable=attribute-defined-outside-init
+        self.sentContextMenuToolbar = QtWidgets.QToolBar()
+        # Popup menu actions container for chans tree
+        self.addressContextMenuToolbar = QtWidgets.QToolBar()
+        # Popup menu actions container for subscriptions tree
+        self.subscriptionsContextMenuToolbar = QtWidgets.QToolBar()
+
+    def updateNetworkSwitchMenuLabel(self, dontconnect=None):
+        _translate = QtCore.QCoreApplication.translate
+        if dontconnect is None:
+            _translate = QtCore.QCoreApplication.translate
+            dontconnect = config.safeGetBoolean(
+                'bitmessagesettings', 'dontconnect')
+        self.actionNetworkSwitch.setText(
+            _translate("MainWindow", "Go online", None)
+            if dontconnect else
+            _translate("MainWindow", "Go offline", None)
+        )
+
     def retranslateUi(self, MainWindow):
         _translate = QtCore.QCoreApplication.translate
         self.MainDock.setWindowTitle(_translate("MainWindow", "Bitmessage"))
@@ -657,6 +704,7 @@
         self.tabWidgetSend.setTabText(self.tabWidgetSend.indexOf(self.tab_2), _translate("MainWindow", "Send Message to your Subscribers"))
         self.pushButtonTTL.setText(_translate("MainWindow", "TTL:"))
         self.labelHumanFriendlyTTLDescription.setText(_translate("MainWindow", "X days"))
+        self.pushButtonClear.setText(_translate("MainWindow", "Clear"))
         self.pushButtonSend.setText(_translate("MainWindow", "Send"))
         self.tabWidget.setTabText(self.tabWidget.indexOf(self.send), _translate("MainWindow", "Send"))
         self.treeWidgetSubscriptions.headerItem().setText(0, _translate("MainWindow", "Subscriptions"))
@@ -703,7 +751,10 @@
         item.setText(_translate("MainWindow", "Name or Label"))
         item = self.tableWidgetBlacklist.horizontalHeaderItem(1)
         item.setText(_translate("MainWindow", "Address"))
+        self.blackwhitelist.retranslateUi()
         self.tabWidget.setTabText(self.tabWidget.indexOf(self.blackwhitelist), _translate("MainWindow", "Blacklist"))
+        self.networkstatus.retranslateUi()
+        self.tabWidget.setTabText(self.tabWidget.indexOf(self.networkstatus), _translate("MainWindow", "Network Status"))
         item = self.tableWidgetConnectionCount.horizontalHeaderItem(0)
         item.setText(_translate("MainWindow", "Stream #"))
         item = self.tableWidgetConnectionCount.horizontalHeaderItem(1)
@@ -726,8 +777,10 @@
         self.actionExit.setShortcut(_translate("MainWindow", "Ctrl+Q"))
         self.actionHelp.setText(_translate("MainWindow", "Help"))
         self.actionHelp.setShortcut(_translate("MainWindow", "F1"))
+        self.actionSupport.setText(_translate("MainWindow", "Contact support"))
         self.actionAbout.setText(_translate("MainWindow", "About"))
         self.actionSettings.setText(_translate("MainWindow", "Settings"))
         self.actionRegenerateDeterministicAddresses.setText(_translate("MainWindow", "Regenerate deterministic addresses"))
         self.actionDeleteAllTrashedMessages.setText(_translate("MainWindow", "Delete all trashed messages"))
         self.actionJoinChan.setText(_translate("MainWindow", "Join / Create chan"))
+        self.updateNetworkSwitchMenuLabel()
